d8a857620130b7fdd4245c0d31a47a21
"use strict";
/**
 * Azure Service Mocks for Unit Testing
 *
 * Comprehensive mocking setup for all Azure services used in PrepBettr,
 * providing realistic behavior simulation for reliable unit testing.
 *
 * @version 2.0.0
 */
var __await = (this && this.__await) || function (v) { return this instanceof __await ? (this.v = v, this) : new __await(v); }
var __asyncGenerator = (this && this.__asyncGenerator) || function (thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = Object.create((typeof AsyncIterator === "function" ? AsyncIterator : Object).prototype), verb("next"), verb("throw"), verb("return", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;
    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }
    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.mockFirebaseAdmin = exports.mockTelemetryClient = exports.mockSecretClient = exports.mockSignalRService = exports.mockOpenAIClient = exports.mockBlobServiceClient = exports.mockCosmosClient = exports.PerformanceMocks = exports.MockHelpers = exports.setMockCosmosData = void 0;
exports.setupAzureMocks = setupAzureMocks;
exports.resetAzureMocks = resetAzureMocks;
const globals_1 = require("@jest/globals");
// ===== COSMOS DB MOCKS =====
let mockData = {};
const mockCosmosClient = {
    database: globals_1.jest.fn().mockReturnValue({
        container: globals_1.jest.fn().mockReturnValue({
            items: {
                create: globals_1.jest.fn().mockResolvedValue({
                    resource: Object.assign({ id: 'test-id' }, mockData),
                    statusCode: 201
                }),
                upsert: globals_1.jest.fn().mockResolvedValue({
                    resource: Object.assign({ id: 'test-id' }, mockData),
                    statusCode: 200
                }),
                query: globals_1.jest.fn().mockReturnValue({
                    fetchAll: globals_1.jest.fn().mockResolvedValue({
                        resources: [Object.assign({ id: 'test-id' }, mockData)]
                    }),
                    fetchNext: globals_1.jest.fn().mockResolvedValue({
                        resources: [Object.assign({ id: 'test-id' }, mockData)],
                        hasMoreResults: false
                    })
                })
            },
            item: globals_1.jest.fn().mockReturnValue({
                read: globals_1.jest.fn().mockResolvedValue({
                    resource: Object.assign({ id: 'test-id' }, mockData),
                    statusCode: 200
                }),
                replace: globals_1.jest.fn().mockResolvedValue({
                    resource: Object.assign({ id: 'test-id' }, mockData),
                    statusCode: 200
                }),
                patch: globals_1.jest.fn().mockResolvedValue({
                    resource: Object.assign({ id: 'test-id' }, mockData),
                    statusCode: 200
                }),
                delete: globals_1.jest.fn().mockResolvedValue({
                    resource: undefined,
                    statusCode: 204
                })
            })
        })
    })
};
exports.mockCosmosClient = mockCosmosClient;
const setMockCosmosData = (data) => {
    mockData = data;
};
exports.setMockCosmosData = setMockCosmosData;
// ===== BLOB STORAGE MOCKS =====
const mockBlobServiceClient = {
    getContainerClient: globals_1.jest.fn().mockReturnValue({
        createIfNotExists: globals_1.jest.fn().mockResolvedValue({ succeeded: true }),
        getBlobClient: globals_1.jest.fn().mockReturnValue({
            upload: globals_1.jest.fn().mockResolvedValue({
                requestId: 'test-request-id',
                etag: 'test-etag'
            }),
            download: globals_1.jest.fn().mockResolvedValue({
                readableStreamBody: Buffer.from('test-content'),
                contentLength: 12
            }),
            delete: globals_1.jest.fn().mockResolvedValue({
                requestId: 'test-request-id'
            }),
            generateSasUrl: globals_1.jest.fn().mockReturnValue('https://teststorage.blob.core.windows.net/test-container/test-blob?sas-token')
        }),
        listBlobsFlat: globals_1.jest.fn().mockReturnValue({
            [Symbol.asyncIterator]: function () {
                return __asyncGenerator(this, arguments, function* () {
                    yield yield __await({ name: 'test-blob.txt', properties: { lastModified: new Date() } });
                });
            }
        })
    })
};
exports.mockBlobServiceClient = mockBlobServiceClient;
// ===== AZURE SPEECH SERVICE MOCKS =====
const mockSpeechConfig = {
    fromSubscription: globals_1.jest.fn().mockReturnValue({
        speechSynthesisVoiceName: 'en-US-JennyNeural',
        speechSynthesisOutputFormat: 'Audio16Khz32KBitRateMonoMp3'
    })
};
const mockSpeechSynthesizer = globals_1.jest.fn().mockImplementation(() => ({
    speakTextAsync: globals_1.jest.fn().mockImplementation((text, successCallback, errorCallback) => {
        setTimeout(() => {
            successCallback({
                reason: 'SynthesizingAudioCompleted',
                audioData: new ArrayBuffer(1024)
            });
        }, 100);
    }),
    close: globals_1.jest.fn()
}));
const mockSpeechRecognizer = globals_1.jest.fn().mockImplementation(() => ({
    recognizeOnceAsync: globals_1.jest.fn().mockImplementation((successCallback, errorCallback) => {
        setTimeout(() => {
            successCallback({
                reason: 'RecognizedSpeech',
                text: 'Test recognized text',
                confidence: 0.95
            });
        }, 100);
    }),
    startContinuousRecognitionAsync: globals_1.jest.fn(),
    stopContinuousRecognitionAsync: globals_1.jest.fn(),
    close: globals_1.jest.fn()
}));
// ===== AZURE OPENAI MOCKS =====
const mockOpenAIClient = {
    getChatCompletions: globals_1.jest.fn().mockResolvedValue({
        choices: [{
                message: {
                    role: 'assistant',
                    content: 'Test AI response for interview question'
                },
                finishReason: 'stop'
            }],
        usage: {
            totalTokens: 150,
            promptTokens: 100,
            completionTokens: 50
        }
    }),
    getCompletions: globals_1.jest.fn().mockResolvedValue({
        choices: [{
                text: 'Test completion response',
                finishReason: 'stop'
            }],
        usage: {
            totalTokens: 100
        }
    })
};
exports.mockOpenAIClient = mockOpenAIClient;
// ===== SIGNALR MOCKS =====
const mockSignalRService = {
    getClientAccessToken: globals_1.jest.fn().mockResolvedValue({
        token: 'test-signalr-token',
        url: 'https://test.service.signalr.net'
    }),
    sendToAll: globals_1.jest.fn().mockResolvedValue(undefined),
    sendToGroup: globals_1.jest.fn().mockResolvedValue(undefined),
    sendToUser: globals_1.jest.fn().mockResolvedValue(undefined),
    addUserToGroup: globals_1.jest.fn().mockResolvedValue(undefined),
    removeUserFromGroup: globals_1.jest.fn().mockResolvedValue(undefined)
};
exports.mockSignalRService = mockSignalRService;
// ===== AZURE KEY VAULT MOCKS =====
const mockSecretClient = {
    getSecret: globals_1.jest.fn().mockImplementation((secretName) => {
        const secrets = {
            'firebase-service-account-key': JSON.stringify({
                type: 'service_account',
                project_id: 'test-project',
                private_key: '-----BEGIN PRIVATE KEY-----\ntest-key\n-----END PRIVATE KEY-----',
                client_email: 'test@test-project.iam.gserviceaccount.com'
            }),
            'speech-key': 'test-speech-key',
            'azure-openai-key': 'test-openai-key',
            'azure-openai-endpoint': 'https://test.openai.azure.com'
        };
        return Promise.resolve({
            name: secretName,
            value: secrets[secretName] || 'test-secret-value',
            properties: {
                version: 'test-version'
            }
        });
    }),
    setSecret: globals_1.jest.fn().mockResolvedValue({
        name: 'test-secret',
        properties: { version: 'new-version' }
    }),
    listPropertiesOfSecrets: globals_1.jest.fn().mockReturnValue({
        [Symbol.asyncIterator]: function () {
            return __asyncGenerator(this, arguments, function* () {
                yield yield __await({ name: 'test-secret', enabled: true });
            });
        }
    })
};
exports.mockSecretClient = mockSecretClient;
// ===== APPLICATION INSIGHTS MOCKS =====
const mockTelemetryClient = {
    trackEvent: globals_1.jest.fn(),
    trackException: globals_1.jest.fn(),
    trackMetric: globals_1.jest.fn(),
    trackTrace: globals_1.jest.fn(),
    trackDependency: globals_1.jest.fn(),
    trackRequest: globals_1.jest.fn(),
    flush: globals_1.jest.fn().mockImplementation((callback) => {
        if (callback)
            callback();
    })
};
exports.mockTelemetryClient = mockTelemetryClient;
// ===== FIREBASE AUTH MOCKS =====
const mockFirebaseAdmin = {
    apps: [],
    initializeApp: globals_1.jest.fn().mockReturnValue({
        name: 'test-app'
    }),
    credential: {
        cert: globals_1.jest.fn()
    },
    auth: globals_1.jest.fn().mockReturnValue({
        verifyIdToken: globals_1.jest.fn().mockResolvedValue({
            uid: 'test-uid',
            email: 'test@example.com',
            email_verified: true,
            exp: Math.floor(Date.now() / 1000) + 3600
        }),
        createSessionCookie: globals_1.jest.fn().mockResolvedValue('test-session-cookie'),
        verifySessionCookie: globals_1.jest.fn().mockResolvedValue({
            uid: 'test-uid',
            email: 'test@example.com'
        }),
        getUser: globals_1.jest.fn().mockResolvedValue({
            uid: 'test-uid',
            email: 'test@example.com',
            customClaims: { role: 'user' }
        }),
        setCustomUserClaims: globals_1.jest.fn().mockResolvedValue(undefined),
        deleteUser: globals_1.jest.fn().mockResolvedValue(undefined)
    }),
    firestore: globals_1.jest.fn().mockReturnValue({
        collection: globals_1.jest.fn().mockReturnValue({
            doc: globals_1.jest.fn().mockReturnValue({
                set: globals_1.jest.fn().mockResolvedValue(undefined),
                get: globals_1.jest.fn().mockResolvedValue({
                    exists: true,
                    data: () => ({ test: 'data' })
                }),
                delete: globals_1.jest.fn().mockResolvedValue(undefined)
            })
        })
    })
};
exports.mockFirebaseAdmin = mockFirebaseAdmin;
// ===== MOCK SETUP FUNCTIONS =====
/**
 * Set up all Azure service mocks
 */
function setupAzureMocks() {
    // Cosmos DB
    globals_1.jest.mock('@azure/cosmos', () => ({
        CosmosClient: globals_1.jest.fn().mockImplementation(() => mockCosmosClient)
    }));
    // Blob Storage
    globals_1.jest.mock('@azure/storage-blob', () => ({
        BlobServiceClient: {
            fromConnectionString: globals_1.jest.fn().mockReturnValue(mockBlobServiceClient)
        }
    }));
    // Azure Speech SDK
    globals_1.jest.mock('microsoft-cognitiveservices-speech-sdk', () => ({
        SpeechConfig: mockSpeechConfig,
        SpeechSynthesizer: mockSpeechSynthesizer,
        SpeechRecognizer: mockSpeechRecognizer,
        ResultReason: {
            SynthesizingAudioCompleted: 'SynthesizingAudioCompleted',
            RecognizedSpeech: 'RecognizedSpeech'
        },
        SpeechSynthesisOutputFormat: {
            Audio16Khz32KBitRateMonoMp3: 'Audio16Khz32KBitRateMonoMp3'
        }
    }));
    // Azure OpenAI
    globals_1.jest.mock('@azure/openai', () => ({
        OpenAIApi: globals_1.jest.fn().mockImplementation(() => mockOpenAIClient)
    }));
    // SignalR
    globals_1.jest.mock('@azure/web-pubsub', () => ({
        WebPubSubServiceClient: globals_1.jest.fn().mockImplementation(() => mockSignalRService)
    }));
    // Key Vault
    globals_1.jest.mock('@azure/keyvault-secrets', () => ({
        SecretClient: globals_1.jest.fn().mockImplementation(() => mockSecretClient)
    }));
    // Azure Identity
    globals_1.jest.mock('@azure/identity', () => ({
        DefaultAzureCredential: globals_1.jest.fn()
    }));
    // Application Insights
    globals_1.jest.mock('applicationinsights', () => ({
        TelemetryClient: globals_1.jest.fn().mockImplementation(() => mockTelemetryClient),
        setup: globals_1.jest.fn().mockReturnValue({
            setAutoDependencyCorrelation: globals_1.jest.fn().mockReturnThis(),
            setAutoCollectRequests: globals_1.jest.fn().mockReturnThis(),
            setAutoCollectPerformance: globals_1.jest.fn().mockReturnThis(),
            setAutoCollectExceptions: globals_1.jest.fn().mockReturnThis(),
            setAutoCollectDependencies: globals_1.jest.fn().mockReturnThis(),
            setUseDiskRetryCaching: globals_1.jest.fn().mockReturnThis(),
            start: globals_1.jest.fn()
        })
    }));
    // Firebase Admin
    globals_1.jest.mock('firebase-admin', () => mockFirebaseAdmin);
}
/**
 * Reset all mocks to clean state
 */
function resetAzureMocks() {
    Object.values(mockCosmosClient.database().container().items).forEach((mock) => {
        if (typeof mock === 'function' && mock.mockClear) {
            mock.mockClear();
        }
    });
    Object.values(mockBlobServiceClient.getContainerClient().getBlobClient()).forEach((mock) => {
        if (typeof mock === 'function' && mock.mockClear) {
            mock.mockClear();
        }
    });
    Object.values(mockTelemetryClient).forEach((mock) => {
        if (typeof mock === 'function' && mock.mockClear) {
            mock.mockClear();
        }
    });
    mockData = {};
}
/**
 * Create mock response helpers
 */
exports.MockHelpers = {
    cosmosResponse: (data, statusCode = 200) => ({
        resource: data,
        statusCode,
        requestCharge: 2.5,
        activityId: 'test-activity-id'
    }),
    blobResponse: (content) => ({
        readableStreamBody: Buffer.from(content),
        contentLength: content.length,
        contentType: 'text/plain',
        etag: 'test-etag'
    }),
    speechResponse: (text, confidence = 0.95) => ({
        reason: 'RecognizedSpeech',
        text,
        confidence,
        duration: 1000
    }),
    openaiResponse: (content, tokens = 100) => ({
        choices: [{
                message: { role: 'assistant', content },
                finishReason: 'stop'
            }],
        usage: { totalTokens: tokens }
    })
};
// ===== PERFORMANCE TESTING UTILITIES =====
exports.PerformanceMocks = {
    simulateLatency: (ms) => {
        return new Promise(resolve => setTimeout(resolve, ms));
    },
    mockSlowResponse: (originalMock, latency) => {
        return globals_1.jest.fn().mockImplementation(async (...args) => {
            await exports.PerformanceMocks.simulateLatency(latency);
            return originalMock(...args);
        });
    },
    trackCallTimes: () => {
        const callTimes = [];
        return {
            mock: globals_1.jest.fn().mockImplementation(async (...args) => {
                const start = Date.now();
                // Simulate some processing
                await exports.PerformanceMocks.simulateLatency(10);
                const end = Date.now();
                callTimes.push(end - start);
            }),
            getCallTimes: () => callTimes,
            getAverageTime: () => callTimes.reduce((a, b) => a + b, 0) / callTimes.length
        };
    }
};
// Set up mocks immediately when this module is imported
setupAzureMocks();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2Rpa3NoYW50dmFzaGlzdGhhL1ByZXBCZXR0ci90ZXN0cy9zZXR1cC9henVyZS1tb2Nrcy50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7Ozs7Ozs7Ozs7Ozs7OztBQXFRSCwwQ0ErREM7QUFLRCwwQ0FvQkM7QUEzVkQsMkNBQXFDO0FBRXJDLDhCQUE4QjtBQUU5QixJQUFJLFFBQVEsR0FBUSxFQUFFLENBQUM7QUFFdkIsTUFBTSxnQkFBZ0IsR0FBUTtJQUM1QixRQUFRLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQztRQUNsQyxTQUFTLEVBQUUsY0FBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGVBQWUsQ0FBQztZQUNuQyxLQUFLLEVBQUU7Z0JBQ0wsTUFBTSxFQUFHLGNBQUksQ0FBQyxFQUFFLEVBQVUsQ0FBQyxpQkFBaUIsQ0FBQztvQkFDM0MsUUFBUSxrQkFBSSxFQUFFLEVBQUUsU0FBUyxJQUFLLFFBQVEsQ0FBRTtvQkFDeEMsVUFBVSxFQUFFLEdBQUc7aUJBQ2hCLENBQUM7Z0JBQ0YsTUFBTSxFQUFHLGNBQUksQ0FBQyxFQUFFLEVBQVUsQ0FBQyxpQkFBaUIsQ0FBQztvQkFDM0MsUUFBUSxrQkFBSSxFQUFFLEVBQUUsU0FBUyxJQUFLLFFBQVEsQ0FBRTtvQkFDeEMsVUFBVSxFQUFFLEdBQUc7aUJBQ2hCLENBQUM7Z0JBQ0YsS0FBSyxFQUFFLGNBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUM7b0JBQy9CLFFBQVEsRUFBRyxjQUFJLENBQUMsRUFBRSxFQUFVLENBQUMsaUJBQWlCLENBQUM7d0JBQzdDLFNBQVMsRUFBRSxpQkFBRyxFQUFFLEVBQUUsU0FBUyxJQUFLLFFBQVEsRUFBRztxQkFDNUMsQ0FBQztvQkFDRixTQUFTLEVBQUcsY0FBSSxDQUFDLEVBQUUsRUFBVSxDQUFDLGlCQUFpQixDQUFDO3dCQUM5QyxTQUFTLEVBQUUsaUJBQUcsRUFBRSxFQUFFLFNBQVMsSUFBSyxRQUFRLEVBQUc7d0JBQzNDLGNBQWMsRUFB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IjpbIi9Vc2Vycy9kaWtzaGFudHZhc2hpc3RoYS9QcmVwQmV0dHIvdGVzdHMvc2V0dXAvYXp1cmUtbW9ja3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBenVyZSBTZXJ2aWNlIE1vY2tzIGZvciBVbml0IFRlc3RpbmdcbiAqIFxuICogQ29tcHJlaGVuc2l2ZSBtb2NraW5nIHNldHVwIGZvciBhbGwgQXp1cmUgc2VydmljZXMgdXNlZCBpbiBQcmVwQmV0dHIsXG4gKiBwcm92aWRpbmcgcmVhbGlzdGljIGJlaGF2aW9yIHNpbXVsYXRpb24gZm9yIHJlbGlhYmxlIHVuaXQgdGVzdGluZy5cbiAqIFxuICogQHZlcnNpb24gMi4wLjBcbiAqL1xuXG5pbXBvcnQgeyBqZXN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5cbi8vID09PT09IENPU01PUyBEQiBNT0NLUyA9PT09PVxuXG5sZXQgbW9ja0RhdGE6IGFueSA9IHt9O1xuXG5jb25zdCBtb2NrQ29zbW9zQ2xpZW50OiBhbnkgPSB7XG4gIGRhdGFiYXNlOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICBjb250YWluZXI6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgaXRlbXM6IHtcbiAgICAgICAgY3JlYXRlOiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICAgIHJlc291cmNlOiB7IGlkOiAndGVzdC1pZCcsIC4uLm1vY2tEYXRhIH0sXG4gICAgICAgICAgc3RhdHVzQ29kZTogMjAxXG4gICAgICAgIH0pLFxuICAgICAgICB1cHNlcnQ6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgcmVzb3VyY2U6IHsgaWQ6ICd0ZXN0LWlkJywgLi4ubW9ja0RhdGEgfSxcbiAgICAgICAgICBzdGF0dXNDb2RlOiAyMDBcbiAgICAgICAgfSksXG4gICAgICAgIHF1ZXJ5OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICBmZXRjaEFsbDogKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICAgIHJlc291cmNlczogW3sgaWQ6ICd0ZXN0LWlkJywgLi4ubW9ja0RhdGEgfV1cbiAgICAgICAgICB9KSxcbiAgICAgICAgICBmZXRjaE5leHQ6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgICByZXNvdXJjZXM6IFt7IGlkOiAndGVzdC1pZCcsIC4uLm1vY2tEYXRhIH1dLFxuICAgICAgICAgICAgaGFzTW9yZVJlc3VsdHM6IGZhbHNlXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH0sXG4gICAgICBpdGVtOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgcmVhZDogKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICByZXNvdXJjZTogeyBpZDogJ3Rlc3QtaWQnLCAuLi5tb2NrRGF0YSB9LFxuICAgICAgICAgIHN0YXR1c0NvZGU6IDIwMFxuICAgICAgICB9KSxcbiAgICAgICAgcmVwbGFjZTogKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICByZXNvdXJjZTogeyBpZDogJ3Rlc3QtaWQnLCAuLi5tb2NrRGF0YSB9LFxuICAgICAgICAgIHN0YXR1c0NvZGU6IDIwMFxuICAgICAgICB9KSxcbiAgICAgICAgcGF0Y2g6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgcmVzb3VyY2U6IHsgaWQ6ICd0ZXN0LWlkJywgLi4ubW9ja0RhdGEgfSxcbiAgICAgICAgICBzdGF0dXNDb2RlOiAyMDBcbiAgICAgICAgfSksXG4gICAgICAgIGRlbGV0ZTogKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgICByZXNvdXJjZTogdW5kZWZpbmVkLFxuICAgICAgICAgIHN0YXR1c0NvZGU6IDIwNFxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9KVxuICB9KVxufTtcblxuZXhwb3J0IGNvbnN0IHNldE1vY2tDb3Ntb3NEYXRhID0gKGRhdGE6IGFueSkgPT4ge1xuICBtb2NrRGF0YSA9IGRhdGE7XG59O1xuXG4vLyA9PT09PSBCTE9CIFNUT1JBR0UgTU9DS1MgPT09PT1cblxuY29uc3QgbW9ja0Jsb2JTZXJ2aWNlQ2xpZW50ID0ge1xuICBnZXRDb250YWluZXJDbGllbnQ6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgIGNyZWF0ZUlmTm90RXhpc3RzOiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUoeyBzdWNjZWVkZWQ6IHRydWUgfSksXG4gICAgZ2V0QmxvYkNsaWVudDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICB1cGxvYWQ6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgIHJlcXVlc3RJZDogJ3Rlc3QtcmVxdWVzdC1pZCcsXG4gICAgICAgIGV0YWc6ICd0ZXN0LWV0YWcnXG4gICAgICB9KSxcbiAgICAgIGRvd25sb2FkOiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICByZWFkYWJsZVN0cmVhbUJvZHk6IEJ1ZmZlci5mcm9tKCd0ZXN0LWNvbnRlbnQnKSxcbiAgICAgICAgY29udGVudExlbmd0aDogMTJcbiAgICAgIH0pLFxuICAgICAgZGVsZXRlOiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICByZXF1ZXN0SWQ6ICd0ZXN0LXJlcXVlc3QtaWQnXG4gICAgICB9KSxcbiAgICAgIGdlbmVyYXRlU2FzVXJsOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKFxuICAgICAgICAnaHR0cHM6Ly90ZXN0c3RvcmFnZS5ibG9iLmNvcmUud2luZG93cy5uZXQvdGVzdC1jb250YWluZXIvdGVzdC1ibG9iP3Nhcy10b2tlbidcbiAgICAgIClcbiAgICB9KSxcbiAgICBsaXN0QmxvYnNGbGF0OiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIFtTeW1ib2wuYXN5bmNJdGVyYXRvcl06IGFzeW5jIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgIHlpZWxkIHsgbmFtZTogJ3Rlc3QtYmxvYi50eHQnLCBwcm9wZXJ0aWVzOiB7IGxhc3RNb2RpZmllZDogbmV3IERhdGUoKSB9IH07XG4gICAgICB9XG4gICAgfSlcbiAgfSlcbn07XG5cbi8vID09PT09IEFaVVJFIFNQRUVDSCBTRVJWSUNFIE1PQ0tTID09PT09XG5cbmNvbnN0IG1vY2tTcGVlY2hDb25maWcgPSB7XG4gIGZyb21TdWJzY3JpcHRpb246IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgIHNwZWVjaFN5bnRoZXNpc1ZvaWNlTmFtZTogJ2VuLVVTLUplbm55TmV1cmFsJyxcbiAgICBzcGVlY2hTeW50aGVzaXNPdXRwdXRGb3JtYXQ6ICdBdWRpbzE2S2h6MzJLQml0UmF0ZU1vbm9NcDMnXG4gIH0pXG59O1xuXG5jb25zdCBtb2NrU3BlZWNoU3ludGhlc2l6ZXIgPSBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XG4gIHNwZWFrVGV4dEFzeW5jOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCh0ZXh0OiBhbnksIHN1Y2Nlc3NDYWxsYmFjazogYW55LCBlcnJvckNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIChzdWNjZXNzQ2FsbGJhY2sgYXMgYW55KSh7XG4gICAgICAgIHJlYXNvbjogJ1N5bnRoZXNpemluZ0F1ZGlvQ29tcGxldGVkJyxcbiAgICAgICAgYXVkaW9EYXRhOiBuZXcgQXJyYXlCdWZmZXIoMTAyNClcbiAgICAgIH0pO1xuICAgIH0sIDEwMCk7XG4gIH0pLFxuICBjbG9zZTogamVzdC5mbigpXG59KSk7XG5cbmNvbnN0IG1vY2tTcGVlY2hSZWNvZ25pemVyID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xuICByZWNvZ25pemVPbmNlQXN5bmM6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKHN1Y2Nlc3NDYWxsYmFjazogYW55LCBlcnJvckNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIChzdWNjZXNzQ2FsbGJhY2sgYXMgYW55KSh7XG4gICAgICAgIHJlYXNvbjogJ1JlY29nbml6ZWRTcGVlY2gnLFxuICAgICAgICB0ZXh0OiAnVGVzdCByZWNvZ25pemVkIHRleHQnLFxuICAgICAgICBjb25maWRlbmNlOiAwLjk1XG4gICAgICB9KTtcbiAgICB9LCAxMDApO1xuICB9KSxcbiAgc3RhcnRDb250aW51b3VzUmVjb2duaXRpb25Bc3luYzogamVzdC5mbigpLFxuICBzdG9wQ29udGludW91c1JlY29nbml0aW9uQXN5bmM6IGplc3QuZm4oKSxcbiAgY2xvc2U6IGplc3QuZm4oKVxufSkpO1xuXG4vLyA9PT09PSBBWlVSRSBPUEVOQUkgTU9DS1MgPT09PT1cblxuY29uc3QgbW9ja09wZW5BSUNsaWVudCA9IHtcbiAgZ2V0Q2hhdENvbXBsZXRpb25zOiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgIGNob2ljZXM6IFt7XG4gICAgICBtZXNzYWdlOiB7XG4gICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICBjb250ZW50OiAnVGVzdCBBSSByZXNwb25zZSBmb3IgaW50ZXJ2aWV3IHF1ZXN0aW9uJ1xuICAgICAgfSxcbiAgICAgIGZpbmlzaFJlYXNvbjogJ3N0b3AnXG4gICAgfV0sXG4gICAgdXNhZ2U6IHtcbiAgICAgIHRvdGFsVG9rZW5zOiAxNTAsXG4gICAgICBwcm9tcHRUb2tlbnM6IDEwMCxcbiAgICAgIGNvbXBsZXRpb25Ub2tlbnM6IDUwXG4gICAgfVxuICB9KSxcbiAgZ2V0Q29tcGxldGlvbnM6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgY2hvaWNlczogW3tcbiAgICAgIHRleHQ6ICdUZXN0IGNvbXBsZXRpb24gcmVzcG9uc2UnLFxuICAgICAgZmluaXNoUmVhc29uOiAnc3RvcCdcbiAgICB9XSxcbiAgICB1c2FnZToge1xuICAgICAgdG90YWxUb2tlbnM6IDEwMFxuICAgIH1cbiAgfSlcbn07XG5cbi8vID09PT09IFNJR05BTFIgTU9DS1MgPT09PT1cblxuY29uc3QgbW9ja1NpZ25hbFJTZXJ2aWNlID0ge1xuICBnZXRDbGllbnRBY2Nlc3NUb2tlbjogKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICB0b2tlbjogJ3Rlc3Qtc2lnbmFsci10b2tlbicsXG4gICAgdXJsOiAnaHR0cHM6Ly90ZXN0LnNlcnZpY2Uuc2lnbmFsci5uZXQnXG4gIH0pLFxuICBzZW5kVG9BbGw6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpLFxuICBzZW5kVG9Hcm91cDogKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCksXG4gIHNlbmRUb1VzZXI6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpLFxuICBhZGRVc2VyVG9Hcm91cDogKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCksXG4gIHJlbW92ZVVzZXJGcm9tR3JvdXA6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpXG59O1xuXG4vLyA9PT09PSBBWlVSRSBLRVkgVkFVTFQgTU9DS1MgPT09PT1cblxuY29uc3QgbW9ja1NlY3JldENsaWVudCA9IHtcbiAgZ2V0U2VjcmV0OiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKChzZWNyZXROYW1lOiBhbnkpID0+IHtcbiAgICBjb25zdCBzZWNyZXRzOiBhbnkgPSB7XG4gICAgICAnZmlyZWJhc2Utc2VydmljZS1hY2NvdW50LWtleSc6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdHlwZTogJ3NlcnZpY2VfYWNjb3VudCcsXG4gICAgICAgIHByb2plY3RfaWQ6ICd0ZXN0LXByb2plY3QnLFxuICAgICAgICBwcml2YXRlX2tleTogJy0tLS0tQkVHSU4gUFJJVkFURSBLRVktLS0tLVxcbnRlc3Qta2V5XFxuLS0tLS1FTkQgUFJJVkFURSBLRVktLS0tLScsXG4gICAgICAgIGNsaWVudF9lbWFpbDogJ3Rlc3RAdGVzdC1wcm9qZWN0LmlhbS5nc2VydmljZWFjY291bnQuY29tJ1xuICAgICAgfSksXG4gICAgICAnc3BlZWNoLWtleSc6ICd0ZXN0LXNwZWVjaC1rZXknLFxuICAgICAgJ2F6dXJlLW9wZW5haS1rZXknOiAndGVzdC1vcGVuYWkta2V5JyxcbiAgICAgICdhenVyZS1vcGVuYWktZW5kcG9pbnQnOiAnaHR0cHM6Ly90ZXN0Lm9wZW5haS5henVyZS5jb20nXG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcbiAgICAgIG5hbWU6IHNlY3JldE5hbWUsXG4gICAgICB2YWx1ZTogc2VjcmV0c1tzZWNyZXROYW1lXSB8fCAndGVzdC1zZWNyZXQtdmFsdWUnLFxuICAgICAgcHJvcGVydGllczoge1xuICAgICAgICB2ZXJzaW9uOiAndGVzdC12ZXJzaW9uJ1xuICAgICAgfVxuICAgIH0pO1xuICB9KSxcbiAgc2V0U2VjcmV0OiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgIG5hbWU6ICd0ZXN0LXNlY3JldCcsXG4gICAgcHJvcGVydGllczogeyB2ZXJzaW9uOiAnbmV3LXZlcnNpb24nIH1cbiAgfSksXG4gIGxpc3RQcm9wZXJ0aWVzT2ZTZWNyZXRzOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICBbU3ltYm9sLmFzeW5jSXRlcmF0b3JdOiBhc3luYyBmdW5jdGlvbiogKCkge1xuICAgICAgeWllbGQgeyBuYW1lOiAndGVzdC1zZWNyZXQnLCBlbmFibGVkOiB0cnVlIH07XG4gICAgfVxuICB9KVxufTtcblxuLy8gPT09PT0gQVBQTElDQVRJT04gSU5TSUdIVFMgTU9DS1MgPT09PT1cblxuY29uc3QgbW9ja1RlbGVtZXRyeUNsaWVudCA9IHtcbiAgdHJhY2tFdmVudDogamVzdC5mbigpLFxuICB0cmFja0V4Y2VwdGlvbjogamVzdC5mbigpLFxuICB0cmFja01ldHJpYzogamVzdC5mbigpLFxuICB0cmFja1RyYWNlOiBqZXN0LmZuKCksXG4gIHRyYWNrRGVwZW5kZW5jeTogamVzdC5mbigpLFxuICB0cmFja1JlcXVlc3Q6IGplc3QuZm4oKSxcbiAgZmx1c2g6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGNhbGxiYWNrOiBhbnkpID0+IHtcbiAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XG4gIH0pXG59O1xuXG4vLyA9PT09PSBGSVJFQkFTRSBBVVRIIE1PQ0tTID09PT09XG5cbmNvbnN0IG1vY2tGaXJlYmFzZUFkbWluID0ge1xuICBhcHBzOiBbXSxcbiAgaW5pdGlhbGl6ZUFwcDogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgbmFtZTogJ3Rlc3QtYXBwJ1xuICB9KSxcbiAgY3JlZGVudGlhbDoge1xuICAgIGNlcnQ6IGplc3QuZm4oKVxuICB9LFxuICBhdXRoOiBqZXN0LmZuKCkubW9ja1JldHVyblZhbHVlKHtcbiAgICB2ZXJpZnlJZFRva2VuOiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgdWlkOiAndGVzdC11aWQnLFxuICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJyxcbiAgICAgIGVtYWlsX3ZlcmlmaWVkOiB0cnVlLFxuICAgICAgZXhwOiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSArIDM2MDBcbiAgICB9KSxcbiAgICBjcmVhdGVTZXNzaW9uQ29va2llOiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUoJ3Rlc3Qtc2Vzc2lvbi1jb29raWUnKSxcbiAgICB2ZXJpZnlTZXNzaW9uQ29va2llOiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgdWlkOiAndGVzdC11aWQnLFxuICAgICAgZW1haWw6ICd0ZXN0QGV4YW1wbGUuY29tJ1xuICAgIH0pLFxuICAgIGdldFVzZXI6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICB1aWQ6ICd0ZXN0LXVpZCcsXG4gICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgY3VzdG9tQ2xhaW1zOiB7IHJvbGU6ICd1c2VyJyB9XG4gICAgfSksXG4gICAgc2V0Q3VzdG9tVXNlckNsYWltczogKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCksXG4gICAgZGVsZXRlVXNlcjogKGplc3QuZm4oKSBhcyBhbnkpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZClcbiAgfSksXG4gIGZpcmVzdG9yZTogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgY29sbGVjdGlvbjogamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBkb2M6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICBzZXQ6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpLFxuICAgICAgICBnZXQ6IChqZXN0LmZuKCkgYXMgYW55KS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICAgICAgZXhpc3RzOiB0cnVlLFxuICAgICAgICAgIGRhdGE6ICgpID0+ICh7IHRlc3Q6ICdkYXRhJyB9KVxuICAgICAgICB9KSxcbiAgICAgICAgZGVsZXRlOiAoamVzdC5mbigpIGFzIGFueSkubW9ja1Jlc29sdmVkVmFsdWUodW5kZWZpbmVkKVxuICAgICAgfSlcbiAgICB9KVxuICB9KVxufTtcblxuLy8gPT09PT0gTU9DSyBTRVRVUCBGVU5DVElPTlMgPT09PT1cblxuLyoqXG4gKiBTZXQgdXAgYWxsIEF6dXJlIHNlcnZpY2UgbW9ja3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldHVwQXp1cmVNb2NrcygpIHtcbiAgLy8gQ29zbW9zIERCXG4gIGplc3QubW9jaygnQGF6dXJlL2Nvc21vcycsICgpID0+ICh7XG4gICAgQ29zbW9zQ2xpZW50OiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IG1vY2tDb3Ntb3NDbGllbnQpXG4gIH0pKTtcblxuICAvLyBCbG9iIFN0b3JhZ2VcbiAgamVzdC5tb2NrKCdAYXp1cmUvc3RvcmFnZS1ibG9iJywgKCkgPT4gKHtcbiAgICBCbG9iU2VydmljZUNsaWVudDoge1xuICAgICAgZnJvbUNvbm5lY3Rpb25TdHJpbmc6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUobW9ja0Jsb2JTZXJ2aWNlQ2xpZW50KVxuICAgIH1cbiAgfSkpO1xuXG4gIC8vIEF6dXJlIFNwZWVjaCBTREtcbiAgamVzdC5tb2NrKCdtaWNyb3NvZnQtY29nbml0aXZlc2VydmljZXMtc3BlZWNoLXNkaycsICgpID0+ICh7XG4gICAgU3BlZWNoQ29uZmlnOiBtb2NrU3BlZWNoQ29uZmlnLFxuICAgIFNwZWVjaFN5bnRoZXNpemVyOiBtb2NrU3BlZWNoU3ludGhlc2l6ZXIsXG4gICAgU3BlZWNoUmVjb2duaXplcjogbW9ja1NwZWVjaFJlY29nbml6ZXIsXG4gICAgUmVzdWx0UmVhc29uOiB7XG4gICAgICBTeW50aGVzaXppbmdBdWRpb0NvbXBsZXRlZDogJ1N5bnRoZXNpemluZ0F1ZGlvQ29tcGxldGVkJyxcbiAgICAgIFJlY29nbml6ZWRTcGVlY2g6ICdSZWNvZ25pemVkU3BlZWNoJ1xuICAgIH0sXG4gICAgU3BlZWNoU3ludGhlc2lzT3V0cHV0Rm9ybWF0OiB7XG4gICAgICBBdWRpbzE2S2h6MzJLQml0UmF0ZU1vbm9NcDM6ICdBdWRpbzE2S2h6MzJLQml0UmF0ZU1vbm9NcDMnXG4gICAgfVxuICB9KSk7XG5cbiAgLy8gQXp1cmUgT3BlbkFJXG4gIGplc3QubW9jaygnQGF6dXJlL29wZW5haScsICgpID0+ICh7XG4gICAgT3BlbkFJQXBpOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IG1vY2tPcGVuQUlDbGllbnQpXG4gIH0pKTtcblxuICAvLyBTaWduYWxSXG4gIGplc3QubW9jaygnQGF6dXJlL3dlYi1wdWJzdWInLCAoKSA9PiAoe1xuICAgIFdlYlB1YlN1YlNlcnZpY2VDbGllbnQ6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gbW9ja1NpZ25hbFJTZXJ2aWNlKVxuICB9KSk7XG5cbiAgLy8gS2V5IFZhdWx0XG4gIGplc3QubW9jaygnQGF6dXJlL2tleXZhdWx0LXNlY3JldHMnLCAoKSA9PiAoe1xuICAgIFNlY3JldENsaWVudDogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiBtb2NrU2VjcmV0Q2xpZW50KVxuICB9KSk7XG5cbiAgLy8gQXp1cmUgSWRlbnRpdHlcbiAgamVzdC5tb2NrKCdAYXp1cmUvaWRlbnRpdHknLCAoKSA9PiAoe1xuICAgIERlZmF1bHRBenVyZUNyZWRlbnRpYWw6IGplc3QuZm4oKVxuICB9KSk7XG5cbiAgLy8gQXBwbGljYXRpb24gSW5zaWdodHNcbiAgamVzdC5tb2NrKCdhcHBsaWNhdGlvbmluc2lnaHRzJywgKCkgPT4gKHtcbiAgICBUZWxlbWV0cnlDbGllbnQ6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gbW9ja1RlbGVtZXRyeUNsaWVudCksXG4gICAgc2V0dXA6IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgc2V0QXV0b0RlcGVuZGVuY3lDb3JyZWxhdGlvbjogamVzdC5mbigpLm1vY2tSZXR1cm5UaGlzKCksXG4gICAgICBzZXRBdXRvQ29sbGVjdFJlcXVlc3RzOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgIHNldEF1dG9Db2xsZWN0UGVyZm9ybWFuY2U6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgc2V0QXV0b0NvbGxlY3RFeGNlcHRpb25zOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgIHNldEF1dG9Db2xsZWN0RGVwZW5kZW5jaWVzOiBqZXN0LmZuKCkubW9ja1JldHVyblRoaXMoKSxcbiAgICAgIHNldFVzZURpc2tSZXRyeUNhY2hpbmc6IGplc3QuZm4oKS5tb2NrUmV0dXJuVGhpcygpLFxuICAgICAgc3RhcnQ6IGplc3QuZm4oKVxuICAgIH0pXG4gIH0pKTtcblxuICAvLyBGaXJlYmFzZSBBZG1pblxuICBqZXN0Lm1vY2soJ2ZpcmViYXNlLWFkbWluJywgKCkgPT4gbW9ja0ZpcmViYXNlQWRtaW4pO1xufVxuXG4vKipcbiAqIFJlc2V0IGFsbCBtb2NrcyB0byBjbGVhbiBzdGF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRBenVyZU1vY2tzKCkge1xuICBPYmplY3QudmFsdWVzKG1vY2tDb3Ntb3NDbGllbnQuZGF0YWJhc2UoKS5jb250YWluZXIoKS5pdGVtcykuZm9yRWFjaCgobW9jazogYW55KSA9PiB7XG4gICAgaWYgKHR5cGVvZiBtb2NrID09PSAnZnVuY3Rpb24nICYmIG1vY2subW9ja0NsZWFyKSB7XG4gICAgICBtb2NrLm1vY2tDbGVhcigpO1xuICAgIH1cbiAgfSk7XG5cbiAgT2JqZWN0LnZhbHVlcygobW9ja0Jsb2JTZXJ2aWNlQ2xpZW50LmdldENvbnRhaW5lckNsaWVudCgpIGFzIGFueSkuZ2V0QmxvYkNsaWVudCgpKS5mb3JFYWNoKChtb2NrOiBhbnkpID0+IHtcbiAgICBpZiAodHlwZW9mIG1vY2sgPT09ICdmdW5jdGlvbicgJiYgbW9jay5tb2NrQ2xlYXIpIHtcbiAgICAgIG1vY2subW9ja0NsZWFyKCk7XG4gICAgfVxuICB9KTtcblxuICBPYmplY3QudmFsdWVzKG1vY2tUZWxlbWV0cnlDbGllbnQpLmZvckVhY2goKG1vY2s6IGFueSkgPT4ge1xuICAgIGlmICh0eXBlb2YgbW9jayA9PT0gJ2Z1bmN0aW9uJyAmJiBtb2NrLm1vY2tDbGVhcikge1xuICAgICAgbW9jay5tb2NrQ2xlYXIoKTtcbiAgICB9XG4gIH0pO1xuXG4gIG1vY2tEYXRhID0ge307XG59XG5cbi8qKlxuICogQ3JlYXRlIG1vY2sgcmVzcG9uc2UgaGVscGVyc1xuICovXG5leHBvcnQgY29uc3QgTW9ja0hlbHBlcnMgPSB7XG4gIGNvc21vc1Jlc3BvbnNlOiAoZGF0YTogYW55LCBzdGF0dXNDb2RlID0gMjAwKSA9PiAoe1xuICAgIHJlc291cmNlOiBkYXRhLFxuICAgIHN0YXR1c0NvZGUsXG4gICAgcmVxdWVzdENoYXJnZTogMi41LFxuICAgIGFjdGl2aXR5SWQ6ICd0ZXN0LWFjdGl2aXR5LWlkJ1xuICB9KSxcblxuICBibG9iUmVzcG9uc2U6IChjb250ZW50OiBzdHJpbmcpID0+ICh7XG4gICAgcmVhZGFibGVTdHJlYW1Cb2R5OiBCdWZmZXIuZnJvbShjb250ZW50KSxcbiAgICBjb250ZW50TGVuZ3RoOiBjb250ZW50Lmxlbmd0aCxcbiAgICBjb250ZW50VHlwZTogJ3RleHQvcGxhaW4nLFxuICAgIGV0YWc6ICd0ZXN0LWV0YWcnXG4gIH0pLFxuXG4gIHNwZWVjaFJlc3BvbnNlOiAodGV4dDogc3RyaW5nLCBjb25maWRlbmNlID0gMC45NSkgPT4gKHtcbiAgICByZWFzb246ICdSZWNvZ25pemVkU3BlZWNoJyxcbiAgICB0ZXh0LFxuICAgIGNvbmZpZGVuY2UsXG4gICAgZHVyYXRpb246IDEwMDBcbiAgfSksXG5cbiAgb3BlbmFpUmVzcG9uc2U6IChjb250ZW50OiBzdHJpbmcsIHRva2VucyA9IDEwMCkgPT4gKHtcbiAgICBjaG9pY2VzOiBbe1xuICAgICAgbWVzc2FnZTogeyByb2xlOiAnYXNzaXN0YW50JywgY29udGVudCB9LFxuICAgICAgZmluaXNoUmVhc29uOiAnc3RvcCdcbiAgICB9XSxcbiAgICB1c2FnZTogeyB0b3RhbFRva2VuczogdG9rZW5zIH1cbiAgfSlcbn07XG5cbi8vID09PT09IFBFUkZPUk1BTkNFIFRFU1RJTkcgVVRJTElUSUVTID09PT09XG5cbmV4cG9ydCBjb25zdCBQZXJmb3JtYW5jZU1vY2tzID0ge1xuICBzaW11bGF0ZUxhdGVuY3k6IChtczogbnVtYmVyKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xuICB9LFxuXG4gIG1vY2tTbG93UmVzcG9uc2U6IChvcmlnaW5hbE1vY2s6IGFueSwgbGF0ZW5jeTogbnVtYmVyKSA9PiB7XG4gICAgcmV0dXJuIGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oYXN5bmMgKC4uLmFyZ3MpID0+IHtcbiAgICAgIGF3YWl0IFBlcmZvcm1hbmNlTW9ja3Muc2ltdWxhdGVMYXRlbmN5KGxhdGVuY3kpO1xuICAgICAgcmV0dXJuIG9yaWdpbmFsTW9jayguLi5hcmdzKTtcbiAgICB9KTtcbiAgfSxcblxuICB0cmFja0NhbGxUaW1lczogKCkgPT4ge1xuICAgIGNvbnN0IGNhbGxUaW1lczogbnVtYmVyW10gPSBbXTtcbiAgICByZXR1cm4ge1xuICAgICAgbW9jazogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbihhc3luYyAoLi4uYXJncykgPT4ge1xuICAgICAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgICAgIC8vIFNpbXVsYXRlIHNvbWUgcHJvY2Vzc2luZ1xuICAgICAgICBhd2FpdCBQZXJmb3JtYW5jZU1vY2tzLnNpbXVsYXRlTGF0ZW5jeSgxMCk7XG4gICAgICAgIGNvbnN0IGVuZCA9IERhdGUubm93KCk7XG4gICAgICAgIGNhbGxUaW1lcy5wdXNoKGVuZCAtIHN0YXJ0KTtcbiAgICAgIH0pLFxuICAgICAgZ2V0Q2FsbFRpbWVzOiAoKSA9PiBjYWxsVGltZXMsXG4gICAgICBnZXRBdmVyYWdlVGltZTogKCkgPT4gY2FsbFRpbWVzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApIC8gY2FsbFRpbWVzLmxlbmd0aFxuICAgIH07XG4gIH1cbn07XG5cbi8vIFNldCB1cCBtb2NrcyBpbW1lZGlhdGVseSB3aGVuIHRoaXMgbW9kdWxlIGlzIGltcG9ydGVkXG5zZXR1cEF6dXJlTW9ja3MoKTtcblxuZXhwb3J0IHtcbiAgbW9ja0Nvc21vc0NsaWVudCxcbiAgbW9ja0Jsb2JTZXJ2aWNlQ2xpZW50LFxuICBtb2NrT3BlbkFJQ2xpZW50LFxuICBtb2NrU2lnbmFsUlNlcnZpY2UsXG4gIG1vY2tTZWNyZXRDbGllbnQsXG4gIG1vY2tUZWxlbWV0cnlDbGllbnQsXG4gIG1vY2tGaXJlYmFzZUFkbWluXG59O1xuIl0sInZlcnNpb24iOjN9
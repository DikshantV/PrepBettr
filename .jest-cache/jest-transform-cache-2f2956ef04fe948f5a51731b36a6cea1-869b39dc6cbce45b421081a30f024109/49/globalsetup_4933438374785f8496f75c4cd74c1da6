2cb1ae7afe1153228335ea6c0c1a8386
"use strict";
/**
 * Global Jest Setup for PrepBettr Testing Suite
 *
 * Sets up global test environment, mocks, and shared utilities
 * that are needed across all test files.
 */
Object.defineProperty(exports, "__esModule", { value: true });
// import 'jest-extended';
// Mock Next.js environment variables
Object.defineProperty(process.env, 'NODE_ENV', {
    value: 'test',
    writable: true,
    enumerable: true,
    configurable: true
});
process.env.NEXT_PUBLIC_APP_URL = 'http://localhost:3000';
process.env.NEXT_PUBLIC_ENVIRONMENT = 'test';
// Mock Azure environment variables
process.env.AZURE_OPENAI_KEY = 'test-azure-openai-key';
process.env.AZURE_OPENAI_ENDPOINT = 'https://test-openai.openai.azure.com';
process.env.AZURE_OPENAI_DEPLOYMENT = 'test-deployment';
process.env.AZURE_SPEECH_KEY = 'test-speech-key';
process.env.AZURE_SPEECH_REGION = 'eastus';
process.env.AZURE_KEY_VAULT_URI = 'https://test-keyvault.vault.azure.net/';
// Mock Firebase environment variables
process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID = 'test-project';
process.env.NEXT_PUBLIC_FIREBASE_API_KEY = 'test-api-key';
process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN = 'test-project.firebaseapp.com';
process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET = 'test-project.appspot.com';
process.env.FIREBASE_ADMIN_PRIVATE_KEY = 'test-private-key';
process.env.FIREBASE_ADMIN_CLIENT_EMAIL = 'test@test-project.iam.gserviceaccount.com';
// Mock Dodo Payments
process.env.DODO_API_KEY = 'test-dodo-api-key';
// Suppress console warnings in tests
const originalWarn = console.warn;
const originalError = console.error;
beforeAll(() => {
    console.warn = jest.fn((message) => {
        // Only suppress specific warnings we expect in tests
        if (typeof message === 'string' && (message.includes('Warning: ReactDOM.render is deprecated') ||
            message.includes('Warning: componentWillReceiveProps') ||
            message.includes('gRPC') ||
            message.includes('FIRESTORE_PREFER_REST'))) {
            return;
        }
        originalWarn(message);
    });
    console.error = jest.fn((message) => {
        // Only suppress specific errors we expect in tests
        if (typeof message === 'string' && (message.includes('Firebase Admin SDK') ||
            message.includes('GRPC_VERBOSITY'))) {
            return;
        }
        originalError(message);
    });
});
afterAll(() => {
    console.warn = originalWarn;
    console.error = originalError;
});
// Mock WebSocket for voice tests
const MockWebSocket = jest.fn().mockImplementation(() => ({
    readyState: 1,
    send: jest.fn(),
    close: jest.fn(),
    addEventListener: jest.fn(),
    removeEventListener: jest.fn(),
}));
// Add static constants
MockWebSocket.CONNECTING = 0;
MockWebSocket.OPEN = 1;
MockWebSocket.CLOSING = 2;
MockWebSocket.CLOSED = 3;
global.WebSocket = MockWebSocket;
// Mock MediaDevices API for audio tests
global.navigator = global.navigator || {};
Object.defineProperty(global.navigator, 'mediaDevices', {
    writable: true,
    value: {
        getUserMedia: jest.fn().mockResolvedValue({
            getAudioTracks: () => [{
                    stop: jest.fn(),
                    enabled: true
                }],
            getTracks: () => [{
                    stop: jest.fn(),
                    enabled: true
                }]
        })
    }
});
// Mock AudioContext
global.AudioContext = jest.fn().mockImplementation(() => ({
    createAnalyser: jest.fn(() => ({
        connect: jest.fn(),
        disconnect: jest.fn(),
        fftSize: 256,
        frequencyBinCount: 128,
        getByteFrequencyData: jest.fn(),
        getFloatFrequencyData: jest.fn(),
    })),
    createGain: jest.fn(() => ({
        connect: jest.fn(),
        disconnect: jest.fn(),
        gain: { value: 1 }
    })),
    createMediaStreamSource: jest.fn(() => ({
        connect: jest.fn(),
        disconnect: jest.fn()
    })),
    destination: {},
    close: jest.fn().mockResolvedValue(undefined),
    state: 'running'
}));
// Mock performance API
Object.defineProperty(global, 'performance', {
    writable: true,
    value: {
        now: jest.fn(() => Date.now()),
        mark: jest.fn(),
        measure: jest.fn(),
        getEntriesByName: jest.fn(() => []),
        getEntriesByType: jest.fn(() => []),
    }
});
// Setup global fetch mock
global.fetch = jest.fn();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2Rpa3NoYW50dmFzaGlzdGhhL1ByZXBCZXR0ci90ZXN0cy9zZXR1cC9nbG9iYWwtc2V0dXAudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOztBQUVILDBCQUEwQjtBQUUxQixxQ0FBcUM7QUFDckMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLFVBQVUsRUFBRTtJQUM3QyxLQUFLLEVBQUUsTUFBTTtJQUNiLFFBQVEsRUFBRSxJQUFJO0lBQ2QsVUFBVSxFQUFFLElBQUk7SUFDaEIsWUFBWSxFQUFFLElBQUk7Q0FDbkIsQ0FBQyxDQUFDO0FBQ0gsT0FBTyxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsR0FBRyx1QkFBdUIsQ0FBQztBQUMxRCxPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUF1QixHQUFHLE1BQU0sQ0FBQztBQUU3QyxtQ0FBbUM7QUFDbkMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsR0FBRyx1QkFBdUIsQ0FBQztBQUN2RCxPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixHQUFHLHNDQUFzQyxDQUFDO0FBQzNFLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLEdBQUcsaUJBQWlCLENBQUM7QUFDeEQsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsR0FBRyxpQkFBaUIsQ0FBQztBQUNqRCxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixHQUFHLFFBQVEsQ0FBQztBQUMzQyxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixHQUFHLHdDQUF3QyxDQUFDO0FBRTNFLHNDQUFzQztBQUN0QyxPQUFPLENBQUMsR0FBRyxDQUFDLCtCQUErQixHQUFHLGNBQWMsQ0FBQztBQUM3RCxPQUFPLENBQUMsR0FBRyxDQUFDLDRCQUE0QixHQUFHLGNBQWMsQ0FBQztBQUMxRCxPQUFPLENBQUMsR0FBRyxDQUFDLGdDQUFnQyxHQUFHLDhCQUE4QixDQUFDO0FBQzlFLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUNBQW1DLEdBQUcsMEJBQTBCLENBQUM7QUFDN0UsT0FBTyxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsR0FBRyxrQkFBa0IsQ0FBQztBQUM1RCxPQUFPLENBQUMsR0FBRyxDQUFDLDJCQUEyQixHQUFHLDJDQUEyQyxDQUFDO0FBRXRGLHFCQUFxQjtBQUNyQixPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksR0FBRyxtQkFBbUIsQ0FBQztBQUUvQyxxQ0FBcUM7QUFDckMsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNsQyxNQUFNLGFBQWEsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDO0FBRXBDLFNBQVMsQ0FBQyxHQUFHLEVBQUU7SUFDYixPQUFPLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRTtRQUNqQyxxREFBcUQ7UUFDckQsSUFDRSxPQUFPLE9BQU8sS0FBSyxRQUFRLElBQUksQ0FDN0IsT0FBTyxDQUFDLFFBQVEsQ0FBQyx3Q0FBd0MsQ0FBQztZQUMxRCxPQUFPLENBQUMsUUFBUSxDQUFDLG9DQUFvQyxDQUFDO1lBQ3RELE9BQU8sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDO1lBQ3hCLE9BQU8sQ0FBQyxRQUFRLENBQUMsdUJBQXVCLENBQUMsQ0FDMUMsRUFDRCxDQUFDO1lBQ0QsT0FBTztRQUNULENBQUM7UUFDRCxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDeEIsQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRTtRQUNsQyxtREFBbUQ7UUFDbkQsSUFDRSxPQUFPLE9BQU8sS0FBSyxRQUFRLElBQUksQ0FDN0IsT0FBTyxDQUFDLFFBQVEsQ0FBQyxvQkFBb0IsQ0FBQztZQUN0QyxPQUFPLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLENBQ25DLEVBQ0QsQ0FBQztZQUNELE9BQU87UUFDVCxDQUFDO1FBQ0QsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3pCLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUM7QUFFSCxRQUFRLENBQUMsR0FBRyxFQUFFO0lBQ1osT0FBTyxDQUFDLElBQUksR0FBRyxZQUFZLENBQUM7SUFDNUIsT0FBTyxDQUFDLEtBQUssR0FBRyxhQUFhLENBQUM7QUFDaEMsQ0FBQyxDQUFDLENBQUM7QUFFSCxpQ0FBaUM7QUFDakMsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDeEQsVUFBVSxFQUFFLENBQUM7SUFDYixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ2hCLGdCQUFnQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDM0IsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtDQUMvQixDQUFDLENBQUMsQ0FBQztBQUVKLHVCQUF1QjtBQUN0QixhQUFxQixDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUM7QUFDckMsYUFBcUIsQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO0FBQy9CLGFBQXFCLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQztBQUNsQyxhQUFxQixDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFFbEMsTUFBTSxDQUFDLFNBQVMsR0FBRyxhQUFvQixDQUFDO0FBRXhDLHdDQUF3QztBQUN4QyxNQUFNLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxTQUFTLElBQUksRUFBRSxDQUFDO0FBQzFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxjQUFjLEVBQUU7SUFDdEQsUUFBUSxFQUFFLElBQUk7SUFDZCxLQUFLLEVBQUU7UUFDTCxZQUFZLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGlCQUFpQixDQUFDO1lBQ3hDLGNBQWMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO29CQUNyQixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtvQkFDZixPQUFPLEVBQUUsSUFBSTtpQkFDZCxDQUFDO1lBQ0YsU0FBUyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7b0JBQ2hCLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO29CQUNmLE9BQU8sRUFBRSxJQUFJO2lCQUNkLENBQUM7U0FDSCxDQUFDO0tBQ0g7Q0FDRixDQUFDLENBQUM7QUFFSCxvQkFBb0I7QUFDcEIsTUFBTSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsa0JBQWtCLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUN4RCxjQUFjLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQzdCLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2xCLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ3JCLE9BQU8sRUFBRSxHQUFHO1FBQ1osaUJBQWlCLEVBQUUsR0FBRztRQUN0QixvQkFBb0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQy9CLHFCQUFxQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDakMsQ0FBQyxDQUFDO0lBQ0gsVUFBVSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUN6QixPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNsQixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNyQixJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFO0tBQ25CLENBQUMsQ0FBQztJQUNILHVCQUF1QixFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUN0QyxPQUFPLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNsQixVQUFVLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtLQUN0QixDQUFDLENBQUM7SUFDSCxXQUFXLEVBQUUsRUFBRTtJQUNmLEtBQUssRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDO0lBQzdDLEtBQUssRUFBRSxTQUFTO0NBQ2pCLENBQUMsQ0FBQyxDQUFDO0FBRUosdUJBQXVCO0FBQ3ZCLE1BQU0sQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLGFBQWEsRUFBRTtJQUMzQyxRQUFRLEVBQUUsSUFBSTtJQUNkLEtBQUssRUFBRTtRQUNMLEdBQUcsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUM5QixJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtRQUNmLE9BQU8sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQ2xCLGdCQUFnQixFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDO1FBQ25DLGdCQUFnQixFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDO0tBQ3BDO0NBQ0YsQ0FBQyxDQUFDO0FBRUgsMEJBQTBCO0FBQzFCLE1BQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9kaWtzaGFudHZhc2hpc3RoYS9QcmVwQmV0dHIvdGVzdHMvc2V0dXAvZ2xvYmFsLXNldHVwLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR2xvYmFsIEplc3QgU2V0dXAgZm9yIFByZXBCZXR0ciBUZXN0aW5nIFN1aXRlXG4gKiBcbiAqIFNldHMgdXAgZ2xvYmFsIHRlc3QgZW52aXJvbm1lbnQsIG1vY2tzLCBhbmQgc2hhcmVkIHV0aWxpdGllc1xuICogdGhhdCBhcmUgbmVlZGVkIGFjcm9zcyBhbGwgdGVzdCBmaWxlcy5cbiAqL1xuXG4vLyBpbXBvcnQgJ2plc3QtZXh0ZW5kZWQnO1xuXG4vLyBNb2NrIE5leHQuanMgZW52aXJvbm1lbnQgdmFyaWFibGVzXG5PYmplY3QuZGVmaW5lUHJvcGVydHkocHJvY2Vzcy5lbnYsICdOT0RFX0VOVicsIHtcbiAgdmFsdWU6ICd0ZXN0JyxcbiAgd3JpdGFibGU6IHRydWUsXG4gIGVudW1lcmFibGU6IHRydWUsXG4gIGNvbmZpZ3VyYWJsZTogdHJ1ZVxufSk7XG5wcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUFBfVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCc7XG5wcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19FTlZJUk9OTUVOVCA9ICd0ZXN0JztcblxuLy8gTW9jayBBenVyZSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbnByb2Nlc3MuZW52LkFaVVJFX09QRU5BSV9LRVkgPSAndGVzdC1henVyZS1vcGVuYWkta2V5JztcbnByb2Nlc3MuZW52LkFaVVJFX09QRU5BSV9FTkRQT0lOVCA9ICdodHRwczovL3Rlc3Qtb3BlbmFpLm9wZW5haS5henVyZS5jb20nO1xucHJvY2Vzcy5lbnYuQVpVUkVfT1BFTkFJX0RFUExPWU1FTlQgPSAndGVzdC1kZXBsb3ltZW50JztcbnByb2Nlc3MuZW52LkFaVVJFX1NQRUVDSF9LRVkgPSAndGVzdC1zcGVlY2gta2V5JztcbnByb2Nlc3MuZW52LkFaVVJFX1NQRUVDSF9SRUdJT04gPSAnZWFzdHVzJztcbnByb2Nlc3MuZW52LkFaVVJFX0tFWV9WQVVMVF9VUkkgPSAnaHR0cHM6Ly90ZXN0LWtleXZhdWx0LnZhdWx0LmF6dXJlLm5ldC8nO1xuXG4vLyBNb2NrIEZpcmViYXNlIGVudmlyb25tZW50IHZhcmlhYmxlc1xucHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRklSRUJBU0VfUFJPSkVDVF9JRCA9ICd0ZXN0LXByb2plY3QnO1xucHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRklSRUJBU0VfQVBJX0tFWSA9ICd0ZXN0LWFwaS1rZXknO1xucHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRklSRUJBU0VfQVVUSF9ET01BSU4gPSAndGVzdC1wcm9qZWN0LmZpcmViYXNlYXBwLmNvbSc7XG5wcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19GSVJFQkFTRV9TVE9SQUdFX0JVQ0tFVCA9ICd0ZXN0LXByb2plY3QuYXBwc3BvdC5jb20nO1xucHJvY2Vzcy5lbnYuRklSRUJBU0VfQURNSU5fUFJJVkFURV9LRVkgPSAndGVzdC1wcml2YXRlLWtleSc7XG5wcm9jZXNzLmVudi5GSVJFQkFTRV9BRE1JTl9DTElFTlRfRU1BSUwgPSAndGVzdEB0ZXN0LXByb2plY3QuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20nO1xuXG4vLyBNb2NrIERvZG8gUGF5bWVudHNcbnByb2Nlc3MuZW52LkRPRE9fQVBJX0tFWSA9ICd0ZXN0LWRvZG8tYXBpLWtleSc7XG5cbi8vIFN1cHByZXNzIGNvbnNvbGUgd2FybmluZ3MgaW4gdGVzdHNcbmNvbnN0IG9yaWdpbmFsV2FybiA9IGNvbnNvbGUud2FybjtcbmNvbnN0IG9yaWdpbmFsRXJyb3IgPSBjb25zb2xlLmVycm9yO1xuXG5iZWZvcmVBbGwoKCkgPT4ge1xuICBjb25zb2xlLndhcm4gPSBqZXN0LmZuKChtZXNzYWdlKSA9PiB7XG4gICAgLy8gT25seSBzdXBwcmVzcyBzcGVjaWZpYyB3YXJuaW5ncyB3ZSBleHBlY3QgaW4gdGVzdHNcbiAgICBpZiAoXG4gICAgICB0eXBlb2YgbWVzc2FnZSA9PT0gJ3N0cmluZycgJiYgKFxuICAgICAgICBtZXNzYWdlLmluY2x1ZGVzKCdXYXJuaW5nOiBSZWFjdERPTS5yZW5kZXIgaXMgZGVwcmVjYXRlZCcpIHx8XG4gICAgICAgIG1lc3NhZ2UuaW5jbHVkZXMoJ1dhcm5pbmc6IGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMnKSB8fFxuICAgICAgICBtZXNzYWdlLmluY2x1ZGVzKCdnUlBDJykgfHxcbiAgICAgICAgbWVzc2FnZS5pbmNsdWRlcygnRklSRVNUT1JFX1BSRUZFUl9SRVNUJylcbiAgICAgIClcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgb3JpZ2luYWxXYXJuKG1lc3NhZ2UpO1xuICB9KTtcblxuICBjb25zb2xlLmVycm9yID0gamVzdC5mbigobWVzc2FnZSkgPT4ge1xuICAgIC8vIE9ubHkgc3VwcHJlc3Mgc3BlY2lmaWMgZXJyb3JzIHdlIGV4cGVjdCBpbiB0ZXN0c1xuICAgIGlmIChcbiAgICAgIHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJyAmJiAoXG4gICAgICAgIG1lc3NhZ2UuaW5jbHVkZXMoJ0ZpcmViYXNlIEFkbWluIFNESycpIHx8XG4gICAgICAgIG1lc3NhZ2UuaW5jbHVkZXMoJ0dSUENfVkVSQk9TSVRZJylcbiAgICAgIClcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgb3JpZ2luYWxFcnJvcihtZXNzYWdlKTtcbiAgfSk7XG59KTtcblxuYWZ0ZXJBbGwoKCkgPT4ge1xuICBjb25zb2xlLndhcm4gPSBvcmlnaW5hbFdhcm47XG4gIGNvbnNvbGUuZXJyb3IgPSBvcmlnaW5hbEVycm9yO1xufSk7XG5cbi8vIE1vY2sgV2ViU29ja2V0IGZvciB2b2ljZSB0ZXN0c1xuY29uc3QgTW9ja1dlYlNvY2tldCA9IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gKHtcbiAgcmVhZHlTdGF0ZTogMSxcbiAgc2VuZDogamVzdC5mbigpLFxuICBjbG9zZTogamVzdC5mbigpLFxuICBhZGRFdmVudExpc3RlbmVyOiBqZXN0LmZuKCksXG4gIHJlbW92ZUV2ZW50TGlzdGVuZXI6IGplc3QuZm4oKSxcbn0pKTtcblxuLy8gQWRkIHN0YXRpYyBjb25zdGFudHNcbihNb2NrV2ViU29ja2V0IGFzIGFueSkuQ09OTkVDVElORyA9IDA7XG4oTW9ja1dlYlNvY2tldCBhcyBhbnkpLk9QRU4gPSAxO1xuKE1vY2tXZWJTb2NrZXQgYXMgYW55KS5DTE9TSU5HID0gMjtcbihNb2NrV2ViU29ja2V0IGFzIGFueSkuQ0xPU0VEID0gMztcblxuZ2xvYmFsLldlYlNvY2tldCA9IE1vY2tXZWJTb2NrZXQgYXMgYW55O1xuXG4vLyBNb2NrIE1lZGlhRGV2aWNlcyBBUEkgZm9yIGF1ZGlvIHRlc3RzXG5nbG9iYWwubmF2aWdhdG9yID0gZ2xvYmFsLm5hdmlnYXRvciB8fCB7fTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWwubmF2aWdhdG9yLCAnbWVkaWFEZXZpY2VzJywge1xuICB3cml0YWJsZTogdHJ1ZSxcbiAgdmFsdWU6IHtcbiAgICBnZXRVc2VyTWVkaWE6IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XG4gICAgICBnZXRBdWRpb1RyYWNrczogKCkgPT4gW3tcbiAgICAgICAgc3RvcDogamVzdC5mbigpLFxuICAgICAgICBlbmFibGVkOiB0cnVlXG4gICAgICB9XSxcbiAgICAgIGdldFRyYWNrczogKCkgPT4gW3tcbiAgICAgICAgc3RvcDogamVzdC5mbigpLFxuICAgICAgICBlbmFibGVkOiB0cnVlXG4gICAgICB9XVxuICAgIH0pXG4gIH1cbn0pO1xuXG4vLyBNb2NrIEF1ZGlvQ29udGV4dFxuZ2xvYmFsLkF1ZGlvQ29udGV4dCA9IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4gKHtcbiAgY3JlYXRlQW5hbHlzZXI6IGplc3QuZm4oKCkgPT4gKHtcbiAgICBjb25uZWN0OiBqZXN0LmZuKCksXG4gICAgZGlzY29ubmVjdDogamVzdC5mbigpLFxuICAgIGZmdFNpemU6IDI1NixcbiAgICBmcmVxdWVuY3lCaW5Db3VudDogMTI4LFxuICAgIGdldEJ5dGVGcmVxdWVuY3lEYXRhOiBqZXN0LmZuKCksXG4gICAgZ2V0RmxvYXRGcmVxdWVuY3lEYXRhOiBqZXN0LmZuKCksXG4gIH0pKSxcbiAgY3JlYXRlR2FpbjogamVzdC5mbigoKSA9PiAoe1xuICAgIGNvbm5lY3Q6IGplc3QuZm4oKSxcbiAgICBkaXNjb25uZWN0OiBqZXN0LmZuKCksXG4gICAgZ2FpbjogeyB2YWx1ZTogMSB9XG4gIH0pKSxcbiAgY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2U6IGplc3QuZm4oKCkgPT4gKHtcbiAgICBjb25uZWN0OiBqZXN0LmZuKCksXG4gICAgZGlzY29ubmVjdDogamVzdC5mbigpXG4gIH0pKSxcbiAgZGVzdGluYXRpb246IHt9LFxuICBjbG9zZTogamVzdC5mbigpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCksXG4gIHN0YXRlOiAncnVubmluZydcbn0pKTtcblxuLy8gTW9jayBwZXJmb3JtYW5jZSBBUElcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWwsICdwZXJmb3JtYW5jZScsIHtcbiAgd3JpdGFibGU6IHRydWUsXG4gIHZhbHVlOiB7XG4gICAgbm93OiBqZXN0LmZuKCgpID0+IERhdGUubm93KCkpLFxuICAgIG1hcms6IGplc3QuZm4oKSxcbiAgICBtZWFzdXJlOiBqZXN0LmZuKCksXG4gICAgZ2V0RW50cmllc0J5TmFtZTogamVzdC5mbigoKSA9PiBbXSksXG4gICAgZ2V0RW50cmllc0J5VHlwZTogamVzdC5mbigoKSA9PiBbXSksXG4gIH1cbn0pO1xuXG4vLyBTZXR1cCBnbG9iYWwgZmV0Y2ggbW9ja1xuZ2xvYmFsLmZldGNoID0gamVzdC5mbigpO1xuXG5leHBvcnQge307XG4iXSwidmVyc2lvbiI6M30=
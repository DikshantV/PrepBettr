{"version":3,"names":["cov_2mm7iyq4sh","actualCoverage","s","exports","POST","server_1","require","headers_1","GOOGLE_CLIENT_ID","process","env","GOOGLE_CLIENT_ID_SUFFIX","GOOGLE_CLIENT_SECRET","NEXTAUTH_URL","b","request","f","console","log","error","NextResponse","json","status","state","Math","random","toString","substring","redirectUri","oauthUrl","URL","searchParams","set","cookieStore","cookies","httpOnly","secure","NODE_ENV","maxAge","path","sameSite","success","redirectUrl"],"sources":["/Users/dikshantvashistha/PrepBettr/app/api/auth/google/server/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { cookies } from 'next/headers';\n\nconst GOOGLE_CLIENT_ID = process.env.GOOGLE_CLIENT_ID_SUFFIX;\nconst GOOGLE_CLIENT_SECRET = process.env.GOOGLE_CLIENT_SECRET;\nconst NEXTAUTH_URL = process.env.NEXTAUTH_URL || 'http://localhost:3000';\n\nexport async function POST(request: NextRequest) {\n  try {\n    console.log('üåê Server-side Google auth: Starting OAuth flow');\n    \n    if (!GOOGLE_CLIENT_ID || !GOOGLE_CLIENT_SECRET) {\n      console.error('üåê Server-side Google auth: Missing OAuth credentials');\n      return NextResponse.json(\n        { error: 'OAuth credentials not configured' },\n        { status: 500 }\n      );\n    }\n\n    // Generate OAuth URL\n    const state = Math.random().toString(36).substring(7);\n    const redirectUri = `${NEXTAUTH_URL}/api/auth/google/callback`;\n    \n    const oauthUrl = new URL('https://accounts.google.com/oauth2/v2/auth');\n    oauthUrl.searchParams.set('client_id', GOOGLE_CLIENT_ID);\n    oauthUrl.searchParams.set('redirect_uri', redirectUri);\n    oauthUrl.searchParams.set('response_type', 'code');\n    oauthUrl.searchParams.set('scope', 'openid email profile');\n    oauthUrl.searchParams.set('state', state);\n\n    console.log('üåê Server-side Google auth: Redirecting to Google OAuth');\n    \n    // Store state in cookie for validation\n    const cookieStore = await cookies();\n    cookieStore.set('oauth_state', state, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      maxAge: 300, // 5 minutes\n      path: '/',\n      sameSite: 'lax',\n    });\n\n    // Return redirect URL for client to navigate to\n    return NextResponse.json({\n      success: true,\n      redirectUrl: oauthUrl.toString()\n    });\n\n  } catch (error) {\n    console.error('üåê Server-side Google auth error:', error);\n    return NextResponse.json(\n      { error: 'Server-side authentication failed' },\n      { status: 500 }\n    );\n  }\n}"],"mappings":"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","ignoreList":[]}